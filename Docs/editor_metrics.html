<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Reviewing your code using COBOL Metrics | IBM Z Open Development</title>
    <meta name="description" content="An open IDE for COBOL and PL/I with VS Code">
    
    
    <link rel="preload" href="/assets/css/0.styles.c634b3e4.css" as="style"><link rel="preload" href="/assets/js/app.8c86c5c2.js" as="script"><link rel="preload" href="/assets/js/6.bb61bc35.js" as="script"><link rel="prefetch" href="/assets/js/11.0f0bb0e0.js"><link rel="prefetch" href="/assets/js/2.cda51ec0.js"><link rel="prefetch" href="/assets/js/3.68289986.js"><link rel="prefetch" href="/assets/js/4.5393fa91.js"><link rel="prefetch" href="/assets/js/5.669f518e.js"><link rel="prefetch" href="/assets/js/7.92fe0cf3.js"><link rel="prefetch" href="/assets/js/8.39657cde.js"><link rel="prefetch" href="/assets/js/9.fe0a3045.js"><link rel="prefetch" href="/assets/js/10.6e9ba81b.js"><link rel="prefetch" href="/assets/js/12.a1d90cab.js"><link rel="prefetch" href="/assets/js/13.e5f9f3d1.js"><link rel="prefetch" href="/assets/js/14.50ade007.js"><link rel="prefetch" href="/assets/js/15.d0bbab4b.js"><link rel="prefetch" href="/assets/js/16.57f2b63b.js"><link rel="prefetch" href="/assets/js/17.3deabf90.js"><link rel="prefetch" href="/assets/js/18.73c3231c.js"><link rel="prefetch" href="/assets/js/19.e02ddac9.js"><link rel="prefetch" href="/assets/js/20.f857c9f2.js"><link rel="prefetch" href="/assets/js/21.28c67929.js"><link rel="prefetch" href="/assets/js/22.f456dcbf.js"><link rel="prefetch" href="/assets/js/23.e503992a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c634b3e4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">IBM Z Open Development</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Docs/introduction.html" class="nav-link">Documentation</a></div> <a href="https://github.ibm.com/Zowe-Commercial/wazi-docs/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Docs/introduction.html" class="nav-link">Documentation</a></div> <a href="https://github.ibm.com/Zowe-Commercial/wazi-docs/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Overview</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Docs/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/Docs/getting_started.html" class="sidebar-link">Getting Started</a></li><li><a href="/Docs/userinterface.html" class="sidebar-link">Exploring the user interface</a></li><li><a href="/Docs/samplefiles.html" class="sidebar-link">Exploring the sample files</a></li><li><a href="/Docs/knownissues.html" class="sidebar-link">Known issues and limitations</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Configuration Options</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Docs/setting_toc.html" class="sidebar-link">Setting preferences</a></li><li><a href="/Docs/setting_preferences.html" class="sidebar-link">Setting workspace preferences and user preferences</a></li><li><a href="/Docs/setting_propertygroup.html" class="sidebar-link">Setting property groups</a></li><li><a href="/Docs/setting_fileassociations.html" class="sidebar-link">Setting file associations</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Editing COBOL and PL/I</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Docs/editor_codechanges.html" class="sidebar-link">Making code changes</a></li><li><a href="/Docs/editor_metrics.html" class="active sidebar-link">Reviewing your code using COBOL Metrics</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Using other VS Code Capabilities</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Docs/git_createbranches.html" class="sidebar-link">Creating Git branches</a></li><li><a href="/Docs/git_commitchanges.html" class="sidebar-link">Committing changes into Git branches</a></li><li><a href="/Docs/editor_search.html" class="sidebar-link">Searching for COBOL and PL/I components</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Interacting with z/OS using Zowe</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Docs/zowe_interactwithzos.html" class="sidebar-link">Interacting with z/OS</a></li><li><a href="/Docs/zowe_datasets.html" class="sidebar-link">Manipulating data sets</a></li><li><a href="/Docs/zowe_submitjcl.html" class="sidebar-link">Submitting JCL to compile, link, and run jobs</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="reviewing-your-code-using-cobol-metrics"><a href="#reviewing-your-code-using-cobol-metrics" aria-hidden="true" class="header-anchor">#</a> Reviewing your code using COBOL Metrics</h1> <p>The IDE's COBOL language server provides you with all the editing capabilities discussed above and can also utilize its knowledge about COBOL to provide you with statistical counters for COBOL language elements such as Operators and Operands, as well as use those to compute various complexity metrics, such as <a href="https://en.wikipedia.org/wiki/Halstead_complexity_measures" target="_blank" rel="noopener noreferrer">Halstead metrics<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (also see <a href="https://www.verifysoft.com/en_halstead_metrics.html" target="_blank" rel="noopener noreferrer">[1]<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://www.geeksforgeeks.org/software-engineering-halsteads-software-metrics/" target="_blank" rel="noopener noreferrer">[2]<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://www.tutorialspoint.com/software_engineering/software_design_complexity.htm" target="_blank" rel="noopener noreferrer">[3]<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>). You can use these metrics to assess the complexity of your COBOL programs as well as set thresholds for various quality metrics that you do not want violate.</p> <p>When you open a COBOL program file (for example, <code>COBOL/SAM1.cbl</code>) and click inside the editor, you will see some metrics-related annotations for that file in the editor's status bar at the bottom.</p> <p>To view all of the file's COBOL program metrics, click on the <code>View All Metrics</code> link in the status bar. This will open the metrics view on the right side of the editor. You can also open this view by right-clicking inside your open COBOL program and selecting <code>Program Metrics</code> from the context menu. The metrics view shows a table of available metrics that you can scroll through to review. To learn about each metric, click the <code>(i)</code> icon to access a tooltip.</p> <p>The table is interactive, reacting to your edits as values get recomputed every time you save and showing you change deltas. For example,</p> <ul><li>In <code>SAM1.cbl</code>, go to Line 243 and cut out the entire <code>IF</code> block until Line 270 and save.</li> <li>Check the table again as the <code>Your Change</code> column was updated, showing relative changes for each metric that was impacted. For example, as nested <code>IF-ELSE</code> statements were removed, the <code>Cyclomatic Complexity</code> of the program went down by 5. You can see how many other metrics were also updated. The IDE presents these changes relative to the time you opened the editor. If you close and reopen it the numbers will be reset.</li> <li>As the code that branches out to other paragraphs was cut out, you can see red squiggles and errors in the Problems view telling you about <code>Unreachable Code</code> as no other code calls these paragraphs now.</li> <li>Go back into the editor and press <code>Ctrl+Z</code> (Windows) or <code>Cmd+Z</code> (Mac) to restore the code you cut out to get back to a consistent state.</li></ul> <p>You can also set thresholds for your metrics either in your personal User Preferences or in Workspace Preferences if you want to share these with your team. Follow these steps to set thresholds for your metrics:</p> <ol><li>Open the Preferences editor with <code>File &gt; Settings &gt; Open Preferences</code> and select the Workspace Preferences tab.</li> <li>In the preferences list, expand <code>Zde</code> and select <code>cobol.metrics &gt; Add Value</code>. This adds an empty <code>&quot;zde.cobol.metrics&quot;: [],</code> entry to your settings on the right.</li> <li>Put the cursor inside the array's square brackets, type <code>{}</code>, place the cursor inside the braces, and press <code>Ctrl+Space</code>.</li> <li>The code completion drop down is opened and you can select the <code>&quot;metric&quot;</code> property.</li> <li>Select <code>&quot;cyclomatic-complexity&quot;</code> from the metrics available for threshold that are proposed.</li> <li>Type a comma and press <code>Enter</code>. Then, press <code>Ctrl+Space</code> again to select <code>&quot;direction&quot;: &quot;larger&quot;,</code> and once more to select <code>&quot;value&quot;:</code>. Set the <code>value</code> to 15.</li> <li>You can now use code completion to quickly provide complex preference data objects.</li> <li>Complete the preferences entry to look like this and save:</li></ol> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;zde.cobol.metrics&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;metric&quot;</span><span class="token operator">:</span> <span class="token string">&quot;comments-percentage&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;direction&quot;</span><span class="token operator">:</span> <span class="token string">&quot;smaller&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">15</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;metric&quot;</span><span class="token operator">:</span> <span class="token string">&quot;comments-percentage&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;direction&quot;</span><span class="token operator">:</span> <span class="token string">&quot;larger&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">60</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;metric&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cyclomatic-complexity&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;direction&quot;</span><span class="token operator">:</span> <span class="token string">&quot;larger&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">15</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>If you go back to the <code>SAM1.cbl</code> editor and review the metrics table, you can now see:</p> <ul><li>Another column in the table called <code>Threshold</code> that contains the values you just entered.</li> <li>Messages about threshold violations are displayed on the far right of the table. For example, for <code>SAM1</code>, the Cyclomatic complexity is 29 and therefore larger than the threshold. The comments percentage is smaller than 15% and therefore also shown as a violation.</li> <li>If you open the <code>SAM2.cbl</code> program, both metrics are in the acceptable range.</li></ul> <p><strong>Next step</strong>: <a href="/Docs/git_commitchanges.html">Committing changes into Git branches</a></p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.ibm.com/Zowe-Commercial/wazi-docs/edit/master/docs/Docs/editor_metrics.md" target="_blank" rel="noopener noreferrer">Edit this page on github.</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">7/26/2019, 5:45:27 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Docs/editor_codechanges.html" class="prev">
          Making code changes
        </a></span> <span class="next"><a href="/Docs/git_createbranches.html">
          Creating Git branches
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/6.bb61bc35.js" defer></script><script src="/assets/js/app.8c86c5c2.js" defer></script>
  </body>
</html>
